<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.greentable.DAO.foodDAO">
	<select id="flistDao" resultType="com.greentable.DTO.foodDTO">
	    SELECT * FROM food
	    <where>
	        <if test="f_kind != null and f_kind != ''">
	            AND f_kind = #{f_kind}
	        </if>
	    </where>
	    ORDER BY f_no asc
	</select>
	<select id="searchFoodDao" resultType="com.greentable.DTO.foodDTO">
	   SELECT 
	       f_no, f_name, f_imgfilename, f_add, f_love
	   FROM food
	   <where>
	       <if test="searchType != null and searchType != '' and keyword != null and keyword != ''">
	           AND REPLACE(${searchType}, ' ', '') LIKE '%' || REPLACE(#{keyword}, ' ', '') || '%'
	       </if>
	   </where>
	   /* 순수하게 랜덤으로만 정렬 */
   		ORDER BY DBMS_RANDOM.VALUE
	</select>
	<select id="feditDao" resultType="com.greentable.DTO.foodDTO">
		select * from food where f_no=#{param1}
	</select>
	<select id="fdetailDao" resultType="com.greentable.DTO.foodDTO">
	    SELECT * from food WHERE f_no = #{f_no}
	</select>
	<insert id="finsertDao">
		insert into food(f_no,f_name,f_imgfilename,f_category,f_recipe,f_add, f_ingredient,f_kcalfilename,f_love, f_kind)
		 values(food_seq.nextval,#{f_name},#{f_imgfilename},#{f_category},#{f_recipe},#{f_add},#{f_ingredient},#{f_kcalfilename},#{f_love}, #{f_kind})
	</insert>
	<update id="fupdateDao">
		update food set f_add=#{f_add}, f_ingredient=#{f_ingredient}, f_recipe=#{f_recipe}
		where f_no=#{f_no}
	</update>
	<delete id="fdeleteDao">
		delete from food where f_no = #{param1}
	</delete>
	<update id="updateLove">
	    UPDATE food SET f_love = f_love + 1 WHERE f_no = #{f_no}
	</update>
</mapper>